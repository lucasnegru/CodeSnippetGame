{% extends "base.html" %}
{% block content %}
<h1 style="font-size:1.6rem; font-weight:700; margin-bottom:.5rem;">Aufgaben</h1>
<p class="text-muted" style="margin-bottom:1rem;">Filtere nach Sprache, Level oder Tag.</p>

<form method="get" class="card" style="display:flex; gap:.75rem; flex-wrap:wrap; align-items:flex-end; margin-bottom:1rem;">
  <div>
    <label class="text-muted" style="font-size:.85rem;">Sprache</label><br>
    <select name="language" class="field" style="min-width:180px">
      <option value="">Alle</option>
      <option value="python" {{ 'selected' if lang=='python' else '' }}>Python</option>
      <option value="java" {{ 'selected' if lang=='java' else '' }}>Java</option>
    </select>
  </div>
  <div>
    <label class="text-muted" style="font-size:.85rem;">Level</label><br>
    <select name="level" class="field" style="min-width:120px">
      <option value="">Alle</option>
      {% for lv in [1,2,3,4] %}
      <option value="{{ lv }}" {{ 'selected' if level==lv else '' }}>{{ lv }}</option>
      {% endfor %}
    </select>
  </div>
  <div>
    <label class="text-muted" style="font-size:.85rem;">Tag</label><br>
    <input name="tag" value="{{ tag or '' }}" class="field" placeholder="z. B. arrays, loops" style="min-width:220px"/>
  </div>
  <div style="margin-left:auto">
    <button class="btn btn-dark" type="submit">Filtern</button>
  </div>
</form>

<div class="grid grid-2">
  {% for s in snippets %}
  <a href="{{ url_for('snippet_view', sid=s.id) }}" class="card" style="text-decoration:none;color:inherit;">
    <div class="text-muted" style="font-size:.75rem; text-transform:uppercase; letter-spacing:.06em;">
      Level {{ s.level }} â€¢ {{ s.language|capitalize }}
    </div>
    <div style="font-weight:700; margin-top:.2rem;">{{ s.title }}</div>
    <p class="text-muted line-clamp-2" style="margin-top:.35rem;">{{ s.prompt }}</p>
    {% if s.tags %}
      <div style="margin-top:.5rem; display:flex; gap:.4rem; flex-wrap:wrap;">
        {% for t in s.tags %}
          <span class="tag">{{ t }}</span>
        {% endfor %}
      </div>
    {% endif %}
  </a>
  {% else %}
  <p>Keine Aufgaben gefunden.</p>
  {% endfor %}
</div>
{% endblock %}
